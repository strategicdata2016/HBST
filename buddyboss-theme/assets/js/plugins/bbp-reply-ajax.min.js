/*! 
 * BuddyBoss Theme JavaScript Library 
 * @package BuddyBoss Theme 
 */
jQuery(function(x){function N(e,o,i){if(e.find(".bbp-reply-form form").find("#bbp-template-notices").html(""),"undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media){e.find(".gif-media-search-dropdown").removeClass("open"),e.find("#whats-new-toolbar .toolbar-button").removeClass("active disable");var t=e.find("#whats-new-attachments .forums-attached-gif-container");t.length&&(t.addClass("closed"),t.find(".gif-image-container img").attr("src",""),t[0].style=""),e.find("#bbp_media_gif").length&&e.find("#bbp_media_gif").val(""),void 0!==o&&i&&(void 0!==bp.Nouveau.Media.dropzone_obj[o]&&(bp.Nouveau.Media.dropzone_obj[o].destroy(),bp.Nouveau.Media.dropzone_obj.splice(o,1),bp.Nouveau.Media.dropzone_media.splice(o,1)),e.find('div#forums-post-media-uploader[data-key="'+o+'"]').html(""),e.find('div#forums-post-media-uploader[data-key="'+o+'"]').addClass("closed").removeClass("open"),e.find('div#forums-post-document-uploader[data-key="'+o+'"]').html(""),e.find('div#forums-post-document-uploader[data-key="'+o+'"]').addClass("closed").removeClass("open"),e.find('div#forums-post-video-uploader[data-key="'+o+'"]').html(""),e.find('div#forums-post-video-uploader[data-key="'+o+'"]').addClass("closed").removeClass("open"))}}x("body").hasClass("reply-edit")||x(document).on("submit",".bbp-reply-form form",function(e){if(e.preventDefault(),x(this).hasClass("submitting"))return!1;x(this).addClass("submitting");var o=!0,i=!0,t=x(e.target).find(".bbp-the-content").data("key"),d=!1;void 0!==window.forums_medium_reply_editor&&void 0!==window.forums_medium_reply_editor[t]&&(d=window.forums_medium_reply_editor[t]),(0<x(this).find("#bbp_media").length&&0<x(this).find("#bbp_document").length&&0<x(this).find("#bbp_video").length&&0<x(this).find("#bbp_media_gif").length&&""==x(this).find("#bbp_media").val()&&""==x(this).find("#bbp_document").val()&&""==x(this).find("#bbp_video").val()&&""==x(this).find("#bbp_media_gif").val()||0<x(this).find("#bbp_media").length&&0<x(this).find("#bbp_document").length&&0<x(this).find("#bbp_video").length&&x(this).find("#bbp_media_gif").length<=0&&""==x(this).find("#bbp_media").val()&&""==x(this).find("#bbp_video").val()&&""==x(this).find("#bbp_document").val()||0<x(this).find("#bbp_media_gif").length&&x(this).find("#bbp_media").length<=0&&x(this).find("#bbp_document").length<=0&&x(this).find("#bbp_video").length<=0&&""==x(this).find("#bbp_media_gif").val())&&(i=!1),d&&""===x(x.parseHTML(x(this).find("#bbp_reply_content").val())).text().trim()&&0==i?(x(this).find(".bbp-the-content").addClass("error"),o=!1):d||""!==x.trim(x(this).find("#bbp_reply_content").val())||0!=i?(d&&x(this).find(".bbp-the-content").removeClass("error"),x(this).find("#bbp_reply_content").removeClass("error")):(x(this).find("#bbp_reply_content").addClass("error"),o=!1),o?function(e,o,i,t){var k={action:e,nonce:o};x.each(i,function(e,o){"action"===o.name?k.bbp_reply_form_action=o.value:k[o.name]=o.value});var j=t.closest("#bbpress-forums");x.post(window.bbpReplyAjaxJS.bbp_ajaxurl,k,function(e){if(e.success){j.find(".bbp-reply-form form").removeClass("submitting");var o="",i=x(".bb-quick-reply-form-wrap");if("edit"===e.reply_type)o='<li class="highlight">'+e.content+"</li>",x("#post-"+e.reply_id).parent("li").replaceWith(o);else{if(window.bbpReplyAjaxJS.threaded_reply&&e.reply_parent&&e.reply_parent!==e.reply_id){var t=null,d="1";if(x("#post-"+e.reply_parent).parent("li").data("depth")==window.bbpReplyAjaxJS.threaded_reply_depth){var r=parseInt(window.bbpReplyAjaxJS.threaded_reply_depth)-1;t=x("#post-"+e.reply_parent).closest("li.depth-"+r),d=window.bbpReplyAjaxJS.threaded_reply_depth}else t=x("#post-"+e.reply_parent).parent("li"),d=parseInt(t.data("depth"))+1;var a="ul";j.find(".bb-single-reply-list").is("ol")&&(a="ol"),t.find(">"+a+".bbp-threaded-replies").length||t.append("<"+a+' class="bbp-threaded-replies"></'+a+">"),o='<li class="highlight depth-'+d+'" data-depth="'+d+'">'+e.content+"</li>",t.find(">"+a+".bbp-threaded-replies").append(o)}else if(e.current_page==e.total_pages)o='<li class="highlight depth-1" data-depth="1">'+e.content+"</li>",j.find(".bb-single-reply-list").append(o);else{var n=e.redirect_url,p=n.substring(0,n.indexOf("#"));i.length||i.is(":visible")||(window.location.href=p)}jQuery(window).scroll()}if(""!==e.tags){var l=x("body .item-tags"),s=x("body .item-tags ul");"none"===l.css("display")?(l.append(e.tags),l.show()):(s.remove(),l.append(e.tags))}""!=o&&(x("body").animate({scrollTop:x(o).offset().top},500),setTimeout(function(){x(o).removeClass("highlight")},2e3));var b=j.find(".bbp-reply-form form").find("#forums-post-media-uploader").data("key"),m=!1;if("undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media&&void 0!==bp.Nouveau.Media.dropzone_media&&void 0!==bp.Nouveau.Media.dropzone_media[b]&&bp.Nouveau.Media.dropzone_media[b].length){m=!0;for(var u=0;u<bp.Nouveau.Media.dropzone_media[b].length;u++)bp.Nouveau.Media.dropzone_media[b][u].saved=!0}var f=j.find(".bbp-reply-form form").find("#forums-post-document-uploader").data("key"),c=!1;if("undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media&&void 0!==bp.Nouveau.Media.dropzone_media&&void 0!==bp.Nouveau.Media.dropzone_media[f]&&bp.Nouveau.Media.dropzone_media[f].length){c=!0;for(u=0;u<bp.Nouveau.Media.dropzone_media[f].length;u++)bp.Nouveau.Media.dropzone_media[f][u].saved=!0}var _=j.find(".bbp-reply-form form").find("#forums-post-video-uploader").data("key"),v=!1;if("undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media&&void 0!==bp.Nouveau.Media.dropzone_media&&void 0!==bp.Nouveau.Media.dropzone_media[_]&&bp.Nouveau.Media.dropzone_media[_].length){v=!0;for(u=0;u<bp.Nouveau.Media.dropzone_media[_].length;u++)bp.Nouveau.Media.dropzone_media[_][u].saved=!0}var h=j.find(".bbp-reply-form form").find(".bbp-the-content").data("key");void 0!==window.forums_medium_reply_editor&&void 0!==window.forums_medium_reply_editor[h]&&window.forums_medium_reply_editor[h].resetContent(),j.find(".bbp-reply-form form").find(".bbp-the-content").removeClass("error"),i.length&&i.is(":visible")?j.find(".bbp-reply-form").hide():j.find("#bbp-close-btn").trigger("click"),j.find(".header-total-reply-count.bp-hide").removeClass("bp-hide"),e.total_reply_count&&(j.find(".header-total-reply-count .topic-reply-count").html(e.total_reply_count),j.find(".topic-lead .bs-replies").html(e.total_reply_count),x(".bs-forums-items").removeClass("topic-list-no-replies")),0<j.find(".replies-content .bp-feedback.info").length&&j.find(".replies-content .bp-feedback.info").remove(),j.find("#bbp_reply_content").val(""),N(j,b,m),N(j,f,c),N(j,_,v);var y=j.find(".scrubberpost");if(y.length)for(var w in y)if(x(y[w]).hasClass("post-"+e.reply_id)){var g,C;x(".scrubber").each(function(e,o){if(C=x(o).data("key"),void 0!==window.BuddyBossThemeBbpScrubber.scrubbers[C])return g=window.BuddyBossThemeBbpScrubber.scrubbers[C],!1}),g.total_item=parseInt(g.total_item,10)+1,g.to=parseInt(g.to,10)+1,window.BuddyBossThemeBbpScrubber.goToPost(parseInt(w,10)+1,"",C);break}}else void 0!==e.content&&j.find(".bbp-reply-form form").find("#bbp-template-notices").html(e.content);j.find(".bbp-reply-form form").removeClass("submitting"),x(".bbp-reply-form").trigger("bbp_after_submit_reply_form",{response:e,topic_id:k.bbp_topic_id})})}("reply",window.bbpReplyAjaxJS.reply_nonce,x(this).serializeArray(),x(this)):x(this).removeClass("submitting")});var s={init:function(){this.ajax_call(),this.moveToReply()},ajax_call:function(){x(document).on("click",'a[data-btn-id="bbp-reply-form"]',function(e){e.preventDefault();var o=x(this),i=o.closest("li"),r=o.data("topic-id"),a=i.find(".activity-discussion-title-wrap a").text(),t=i.data("bp-activity"),d=t.group_id?t.group_id:0;x(".bb-quick-reply-form-wrap").length&&x(".bb-quick-reply-form-wrap").remove(),x("body").addClass("bb-modal-overlay-open").append('<div class="bb-modal-overlay js-modal-close"></div>'),x(".bb-modal-overlay").fadeTo(0,1);var n=o.closest(".bb-grid .content-area"),p='<div id="bbpress-forums" class="bbpress-forums-activity bb-quick-reply-form-wrap"><div class="bbp-reply-form bb-modal bb-modal-box"><form id="new-post" name="new-post" method="post" action=""><fieldset class="bbp-form"><legend>'+window.bbpReplyAjaxJS.reply_to_text+' <span id="bbp-reply-exerpt"> '+a+'...</span><a href="#" id="bbp-close-btn" class="js-modal-close"><i class="bb-icon-close"></i></a></legend><div><div class="bbp-the-content-wrapper"><div class="bbp-the-content bbp_editor_reply_content medium-editor-element" contenteditable="true" data-placeholder="'+window.bbpReplyAjaxJS.type_reply_here_text+'"></div></div></fieldset></form></div></div>';n.append(p),n.find(".bb-quick-reply-form-wrap").show(0).find(".bbp-reply-form").addClass("bb-modal bb-modal-box").show(0),n.find(".bb-quick-reply-form-wrap .bbp-the-content-wrapper").addClass("loading").show(0);var l={action:"quick_reply_ajax",topic_id:r,group_id:d,"bbp-ajax":1};x.post(ajaxurl,l,function(e){if(n.append(e),n.find("div.bb-quick-reply-form-wrap").length){var o=n.find("div.bb-quick-reply-form-wrap");if(o.show(),o.not('[data-component="activity"]').hide(),o.find(".bbp-reply-form").length&&(o.find(".bbp-reply-form").addClass("bb-modal bb-modal-box"),o.find(".bbp-reply-form").show(),o.find(".bbp-reply-form").find("#bbp-reply-exerpt").text(a+"..."),o.find(".bbp-reply-form").find("#bbp_topic_id").val(r),s.addSelect2(o),s.addEditor(o),"undefined"!=typeof bp&&void 0!==bp.Nouveau&&void 0!==bp.Nouveau.Media)){if(void 0!==bp.Nouveau.Media.options){var i=o.find(".bbp-reply-form").find(".forum-post-media-template").length?o.find(".bbp-reply-form").find(".forum-post-media-template")[0].innerHTML:"";bp.Nouveau.Media.options.previewTemplate=i}if(void 0!==bp.Nouveau.Media.documentOptions){var t=o.find(".bbp-reply-form").find(".forum-post-document-template").length?o.find(".bbp-reply-form").find(".forum-post-document-template")[0].innerHTML:"";bp.Nouveau.Media.documentOptions.previewTemplate=t}if(void 0!==bp.Nouveau.Media.videoOptions){var d=o.find(".bbp-reply-form").find(".forum-post-video-template").length?o.find(".bbp-reply-form").find(".forum-post-video-template")[0].innerHTML:"";bp.Nouveau.Media.videoOptions.previewTemplate=d}}o.find(".bbp-no-reply").length&&(o.find(".bbp-no-reply").addClass("bb-modal bb-modal-box"),o.find(".bbp-no-reply").show())}})})},addSelect2:function(e){var o=e.find(".bbp_topic_tags_dropdown"),d=[];o.length&&(o.select2({placeholder:o.attr("placeholder"),minimumInputLength:1,closeOnSelect:!0,tags:!0,language:"undefined"!=typeof bp_select2&&void 0!==bp_select2.lang?bp_select2.lang:"en",dropdownCssClass:"bb-select-dropdown",containerCssClass:"bb-select-container",tokenSeparators:[","," "],ajax:{url:bbpCommonJsData.ajax_url,dataType:"json",delay:1e3,data:function(e){return x.extend({},e,{_wpnonce:bbpCommonJsData.nonce,action:"search_tags"})},cache:!0,processResults:function(t){return!1===x.isEmptyObject(d)&&x.each(d,function(e,o){for(var i=0;i<t.data.results.length;i++)t.data.results[i].id===o&&t.data.results.splice(i,1)}),{results:t&&t.success?t.data.results:[]}}}}),o.on("select2:select",function(e){var o=e.params.data;d.push(o.id);var i=d.join(",");x("body #bbp_topic_tags").val(i),x("body .select2-search__field").trigger("click"),x("body .select2-search__field").trigger("click")}),o.on("select2:unselect",function(e){var o=e.params.data,i=(d=x.grep(d,function(e){return e!==o.id})).join(",");x("body #bbp_topic_tags").val(i),0===i.length&&x(window).scrollTop(x(window).scrollTop()+1)}))},addEditor:function(o){if(void 0!==window.MediumEditor){var i={buttons:["bold","italic","unorderedlist","orderedlist","quote","anchor","pre"],relativeContainer:document.getElementById("whats-new-toolbar"),static:!0,updateOnEmptySelection:!0};o.find(".bbp_editor_reply_content").length&&(window.forums_medium_reply_editor=[],o.find(".bbp_editor_reply_content").each(function(e,t){var d=x(t).data("key");window.forums_medium_reply_editor[d]=new window.MediumEditor(t,{placeholder:{text:window.bbpEditorJsStrs.type_reply,hideOnClick:!0},toolbar:i,paste:{forcePlainText:!1,cleanPastedHTML:!0,cleanReplacements:[[new RegExp(/<div/gi),"<p"],[new RegExp(/<\/div/gi),"</p"],[new RegExp(/<h[1-6]/gi),"<b"],[new RegExp(/<\/h[1-6]/gi),"</b"]],cleanAttrs:["class","style","dir","id"],cleanTags:["meta","div","main","section","article","aside","button","svg","canvas","figure","input","textarea","select","label","form","table","thead","tfooter","colgroup","col","tr","td","th","dl","dd","center","caption","nav"],unwrapTags:["ul","ol","li"]},imageDragging:!1,anchor:{linkValidation:!0}}),window.forums_medium_reply_editor[d].subscribe("editableInput",function(){var e=x(t).closest("form").find("#bbp_reply_content"),o=window.forums_medium_reply_editor[d].getContent(),i=document.createElement("div");i.innerHTML=o,x(i).find("span.atwho-query").replaceWith(function(){return this.innerText}),x(i).find("img.emoji").each(function(e,o){x(o).addClass("emojioneemoji");var i=x(o).attr("alt");x(o).attr("data-emoji-char",i),x(o).removeClass("emoji")}),x(i).find("img.emojioneemoji").replaceWith(function(){return this.dataset.emojiChar}),e.val(x(i).html())}),o.on("click","#whats-new-toolbar .show-toolbar",function(e){e.preventDefault();var o=x(e.currentTarget).closest(".bbp-reply-form").find(".bbp_editor_reply_content").data("key"),i=x(e.currentTarget).closest(".bbp-form").find(".medium-editor-toolbar");x(e.currentTarget).find(".toolbar-button").toggleClass("active"),x(e.currentTarget).find(".toolbar-button").hasClass("active")?(x(e.currentTarget).attr("data-bp-tooltip",x(e.currentTarget).attr("data-bp-tooltip-hide")),null!==window.forums_medium_reply_editor[o].exportSelection()&&i.addClass("medium-editor-toolbar-active")):(x(e.currentTarget).attr("data-bp-tooltip",x(e.currentTarget).attr("data-bp-tooltip-show")),null===window.forums_medium_reply_editor[o].exportSelection()&&i.removeClass("medium-editor-toolbar-active")),x(window.forums_medium_reply_editor[o].elements[0]).focus(),i.toggleClass("active")})})),"undefined"!=typeof BP_Nouveau&&void 0!==BP_Nouveau.media&&void 0!==BP_Nouveau.media.emoji&&o.find(".bbp_editor_reply_content").length&&void 0!==x.prototype.emojioneArea&&o.find(".bbp_editor_reply_content").each(function(e,o){var i=x(o).attr("id"),t=x(o).data("key");x("#"+i).emojioneArea({standalone:!0,hideSource:!1,container:x("#"+i).closest("form").find("#whats-new-toolbar > .post-emoji"),autocomplete:!1,pickerPosition:"bottom",hidePickerOnBlur:!0,useInternalCDN:!1,events:{ready:function(){void 0!==window.forums_medium_topic_editor&&void 0!==window.forums_medium_topic_editor[t]&&window.forums_medium_topic_editor[t].resetContent(),void 0!==window.forums_medium_reply_editor&&void 0!==window.forums_medium_reply_editor[t]&&window.forums_medium_reply_editor[t].resetContent(),void 0!==window.forums_medium_forum_editor&&void 0!==window.forums_medium_forum_editor[t]&&window.forums_medium_forum_editor[t].resetContent()},emojibtn_click:function(){void 0!==window.forums_medium_topic_editor&&void 0!==window.forums_medium_topic_editor[t]&&window.forums_medium_topic_editor[t].checkContentChanged(),void 0!==window.forums_medium_reply_editor&&void 0!==window.forums_medium_reply_editor[t]&&window.forums_medium_reply_editor[t].checkContentChanged(),void 0!==window.forums_medium_forum_editor&&void 0!==window.forums_medium_forum_editor[t]&&window.forums_medium_forum_editor[t].checkContentChanged(),x("#"+i)[0].emojioneArea.hidePicker()},search_keypress:function(){var e=this.search.val().toLowerCase();this.search.val(e)}}})})}},moveToReply:function(){if(0<window.location.href.indexOf("#post-")){var e=window.location.href.split("#post-"),o=e&&void 0!==e[1]?e[1]:"";if(!o||0==x("#post-"+o).length)return;var i,t=0;0<x("#wpadminbar").length&&(t=x("#wpadminbar").innerHeight()),i=x("body").hasClass("sticky-header")?x("#post-"+o).parent().offset().top-x("#masthead").innerHeight()-t:x("#post-"+o).parent().offset().top-t,x("html, body").animate({scrollTop:i},200)}}};s.init()});